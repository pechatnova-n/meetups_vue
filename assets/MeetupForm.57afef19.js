import{U as N}from"./UiButton.07576b37.js";import{U as D,a as T}from"./UiInput.d39a7fa4.js";import{_ as S,U as C,h as G}from"./index.c9909d86.js";import{o as m,c as I,d as r,t as w,D as P,u as k,B as R,r as g,i as U,E as B,v as V,w as _,m as Y,k as L,G as E,H as j,F as M,j as O,I as $,a as i,n as q,l as z,p as H,b as J}from"./vendor.30b2d013.js";import{c as K}from"./meetupService.5eb92bb3.js";function h(e){if(typeof e!="object")return e;var t,o,u=Object.prototype.toString.call(e);if(u==="[object Object]"){if(e.constructor!==Object&&typeof e.constructor=="function"){o=new e.constructor;for(t in e)e.hasOwnProperty(t)&&o[t]!==e[t]&&(o[t]=h(e[t]))}else{o={};for(t in e)t==="__proto__"?Object.defineProperty(o,t,{value:h(e[t]),configurable:!0,enumerable:!0,writable:!0}):o[t]=h(e[t])}return o}if(u==="[object Array]"){for(t=e.length,o=Array(t);t--;)o[t]=h(e[t]);return o}return u==="[object Set]"?(o=new Set,e.forEach(function(n){o.add(h(n))}),o):u==="[object Map]"?(o=new Map,e.forEach(function(n,a){o.set(h(a),h(n))}),o):u==="[object Date]"?new Date(+e):u==="[object RegExp]"?(o=new RegExp(e.source,e.flags),o.lastIndex=e.lastIndex,o):u==="[object DataView]"?new e.constructor(h(e.buffer)):u==="[object ArrayBuffer]"?e.slice(0):u.slice(-6)==="Array]"?new e.constructor(e):e}const c={EMPTY:"EMPTY",LOADING:"LOADING",FILLED:"FILLED"},Q={name:"UiImageUploader",inheritAttrs:!1,States:c,props:{uploader:{type:Function},preview:{type:String}},emits:["upload","select","error","remove"],data(){return{state:this.preview?c.FILLED:c.EMPTY,localPreview:null}},computed:{stateText(){return{[c.EMPTY]:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435",[c.LOADING]:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...",[c.FILLED]:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435"}[this.state]},imageSrc(){var e;return(e=this.localPreview)!=null?e:this.preview}},beforeUnmount(){this.localPreview&&URL.revokeObjectURL(this.localPreview)},methods:{async handleFileSelect(e){const t=e.target.files[0];if(this.$emit("select",t),this.localPreview=URL.createObjectURL(t),!this.uploader){this.state=c.FILLED;return}return await this.upload(t)},async upload(e){this.state=c.LOADING;try{const t=await this.uploader(e);this.$emit("upload",t),this.state=c.FILLED}catch(t){this.$emit("error",t),this.state=c.EMPTY,this.removeFile()}},handleClick(e){this.state===c.LOADING?e.preventDefault():this.state===c.FILLED&&(e.preventDefault(),this.removeFile(),this.state=c.EMPTY,this.$emit("remove"))},removeFile(){this.$refs.input.value="",this.localPreview=null}}},W={class:"image-uploader"},X={class:"image-uploader__text"};function Z(e,t,o,u,n,a){return m(),I("div",W,[r("label",{class:k(["image-uploader__preview",{"image-uploader__preview-loading":n.state===e.$options.States.LOADING}]),style:R(n.state!==e.$options.States.EMPTY&&`--bg-url: url('${a.imageSrc}')`)},[r("span",X,w(a.stateText),1),r("input",P({ref:"input",type:"file",accept:"image/*",class:"image-uploader__input"},e.$attrs,{onChange:t[0]||(t[0]=(...d)=>a.handleFileSelect&&a.handleFileSelect(...d)),onClick:t[1]||(t[1]=(...d)=>a.handleClick&&a.handleClick(...d))}),null,16)],6)])}const x=S(Q,[["render",Z],["__scopeId","data-v-5afbc69f"]]),ee={name:"UiInputDate",components:{UiInput:D},props:{modelValue:Number,type:{type:String,default:"date",validator:e=>["date","datetime-local","time"].includes(e)},step:{type:[Number]}},emits:["update:modelValue"],computed:{value(){if(typeof this.modelValue>"u"||this.modelValue===null)return"";const e=new Date(this.modelValue).toISOString();return this.type==="date"?e.substring(0,10):this.type==="datetime-local"?e.substring(0,16):this.type==="time"?this.step&&this.step%60!==0?e.substring(11,19):e.substring(11,16):""}},methods:{handleInput(e){this.$emit("update:modelValue",e.target.value!==""?e.target.valueAsNumber:void 0)}}};function te(e,t,o,u,n,a){const d=g("UiInput");return m(),U(d,{"model-value":a.value,type:o.type,onInput:a.handleInput},B({_:2},[V(Object.keys(e.$slots),p=>({name:p,fn:_(()=>[Y(e.$slots,p)])}))]),1032,["model-value","type","onInput"])}const ne=S(ee,[["render",te]]);const oe={name:"UiDropdown",data(){return{isOpened:!1,hiddenSelectValue:this.modelValue}},components:{UiIcon:C},props:{options:{type:Array,required:!0},modelValue:{type:String},title:{type:String,required:!0}},emits:["update:modelValue"],methods:{toggleOptions(){this.isOpened=!this.isOpened},changeSelectedOption(e){this.$emit("update:modelValue",e.value),this.toggleOptions()}},computed:{selectedOption(){return this.options.find(e=>e.value===this.modelValue)},includeIcon(){return this.options.some(e=>"icon"in e)}},watch:{hiddenSelectValue:{handler(e){this.$emit("update:modelValue",e)}},modelValue:{handler(e){this.hiddenSelectValue=e}}}},ae={class:"dropdown__menu",role:"listbox"},le=["value","onClick"],se=["value"];function ie(e,t,o,u,n,a){var p,f,v;const d=g("UiIcon");return m(),I(M,null,[r("div",{class:k(["dropdown",{dropdown_opened:n.isOpened}])},[r("button",{type:"button",onClick:t[0]||(t[0]=(...l)=>a.toggleOptions&&a.toggleOptions(...l)),class:k(["dropdown__toggle",{dropdown__toggle_icon:a.includeIcon}])},[(p=a.selectedOption)!=null&&p.icon?(m(),U(d,{key:0,icon:(f=a.selectedOption)==null?void 0:f.icon,class:"dropdown__icon"},null,8,["icon"])):L("",!0),r("span",null,w(((v=a.selectedOption)==null?void 0:v.text)||o.title),1)],2),E(r("div",ae,[(m(!0),I(M,null,V(o.options,l=>(m(),I("button",{value:l.value,key:l.value,class:k(["dropdown__item",{dropdown__item_icon:a.includeIcon}]),role:"option",type:"button",onClick:b=>a.changeSelectedOption(l)},[l.icon?(m(),U(d,{key:0,icon:l.icon,class:"dropdown__icon"},null,8,["icon"])):L("",!0),O(" "+w(l.text),1)],10,le))),128))],512),[[j,n.isOpened]])],2),E(r("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>n.hiddenSelectValue=l)},[(m(!0),I(M,null,V(o.options,l=>(m(),I("option",{key:l.value,value:l.value},w(l.text),9,se))),128))],512),[[j,!1],[$,n.hiddenSelectValue]])],64)}const re=S(oe,[["render",ie],["__scopeId","data-v-aab76e73"]]);const ue={registration:"key",opening:"cal-sm",talk:"tv",break:"clock",coffee:"coffee",closing:"key",afterparty:"cal-sm",other:"cal-sm"},de={registration:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F",opening:"\u041E\u0442\u043A\u0440\u044B\u0442\u0438\u0435",break:"\u041F\u0435\u0440\u0435\u0440\u044B\u0432",coffee:"Coffee Break",closing:"\u0417\u0430\u043A\u0440\u044B\u0442\u0438\u0435",afterparty:"Afterparty",talk:"\u0414\u043E\u043A\u043B\u0430\u0434",other:"\u0414\u0440\u0443\u0433\u043E\u0435"},pe=Object.entries(de).map(([e,t])=>({value:e,text:t,icon:ue[e]})),me=[{value:null,text:"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D\u043E"},{value:"RU",text:"RU"},{value:"EN",text:"EN"}],y={title:{label:"\u041D\u0435\u0441\u0442\u0430\u043D\u0434\u0430\u0440\u0442\u043D\u044B\u0439 \u0442\u0435\u043A\u0441\u0442 (\u043D\u0435\u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u043E)",component:"ui-input",props:{name:"title"}}},ce={registration:y,opening:y,talk:{title:{label:"\u0422\u0435\u043C\u0430",component:"ui-input",props:{name:"title"}},speaker:{label:"\u0414\u043E\u043A\u043B\u0430\u0434\u0447\u0438\u043A",component:"ui-input",props:{name:"speaker"}},description:{label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435",component:"ui-input",props:{multiline:!0,name:"description"}},language:{label:"\u042F\u0437\u044B\u043A",component:"ui-dropdown",props:{options:me,title:"\u042F\u0437\u044B\u043A",name:"language"}}},break:y,coffee:y,closing:y,afterparty:y,other:{title:{label:"\u0417\u0430\u0433\u043E\u043B\u043E\u0432\u043E\u043A",component:"ui-input",props:{name:"title"}},description:{label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435",component:"ui-input",props:{multiline:!0,name:"description"}}}},_e={name:"MeetupAgendaItemForm",components:{UiIcon:C,UiFormGroup:T,UiInput:D,UiDropdown:re},agendaItemTypeOptions:pe,agendaItemFormSchemas:ce,props:{agendaItem:{type:Object,required:!0}},emits:["update:agendaItem","remove"],data(){return{localAgendaItem:{...this.agendaItem}}},computed:{startsAt(){return this.localAgendaItem.startsAt}},watch:{localAgendaItem:{deep:!0,handler(){this.$emit("update:agendaItem",{...this.localAgendaItem})}},startsAt(e,t){if(!/([0-1]\d|2[0-3]):[0-5]\d/.test(e))return;const o=l=>{const[b,s]=l.split(":").map(A=>parseInt(A,10));return b*60+s},u=o(e),n=o(t),a=o(this.localAgendaItem.endsAt),d=u-n,p=(a+d+24*60)%(24*60),f=Math.floor(p/60).toString().padStart(2,"0"),v=Math.floor(p%60).toString().padStart(2,"0");this.localAgendaItem.endsAt=`${f}:${v}`}}},ge={class:"agenda-item-form"},fe={class:"agenda-item-form__row"},he={class:"agenda-item-form__col"},Ie={class:"agenda-item-form__col"};function ve(e,t,o,u,n,a){const d=g("UiIcon"),p=g("UiDropdown"),f=g("UiFormGroup"),v=g("UiInput");return m(),I("fieldset",ge,[r("button",{type:"button",class:"agenda-item-form__remove-button",onClick:t[0]||(t[0]=l=>e.$emit("remove"))},[i(d,{icon:"trash"})]),i(f,null,{default:_(()=>[i(p,{title:"\u0422\u0438\u043F",options:e.$options.agendaItemTypeOptions,name:"type",modelValue:n.localAgendaItem.type,"onUpdate:modelValue":t[1]||(t[1]=l=>n.localAgendaItem.type=l)},null,8,["options","modelValue"])]),_:1}),r("div",fe,[r("div",he,[i(f,{label:"\u041D\u0430\u0447\u0430\u043B\u043E"},{default:_(()=>[i(v,{type:"time",placeholder:"00:00",name:"startsAt",modelValue:n.localAgendaItem.startsAt,"onUpdate:modelValue":t[2]||(t[2]=l=>n.localAgendaItem.startsAt=l)},null,8,["modelValue"])]),_:1})]),r("div",Ie,[i(f,{label:"\u041E\u043A\u043E\u043D\u0447\u0430\u043D\u0438\u0435"},{default:_(()=>[i(v,{type:"time",placeholder:"00:00",name:"endsAt",modelValue:n.localAgendaItem.endsAt,"onUpdate:modelValue":t[3]||(t[3]=l=>n.localAgendaItem.endsAt=l)},null,8,["modelValue"])]),_:1})])]),(m(!0),I(M,null,V(e.$options.agendaItemFormSchemas[n.localAgendaItem.type],(l,b)=>(m(),U(f,{key:b,label:l.label},{default:_(()=>[(m(),U(q(l.component),P({modelValue:n.localAgendaItem[b],"onUpdate:modelValue":s=>n.localAgendaItem[b]=s},l.props),null,16,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128))])}const be=S(_e,[["render",ve],["__scopeId","data-v-2a73d341"]]);function ye(e){return G.post("/images/upload",e)}const Ue={name:"MeetupForm",components:{MeetupAgendaItemForm:be,UiButton:N,UiFormGroup:T,UiImageUploader:x,UiInput:D,UiInputDate:ne},props:{meetup:{type:Object,required:!0},submitText:{type:String,default:""}},emits:["submit","cancel"],data(){return{localMeetup:h(this.meetup)}},methods:{postImage:ye,addAgendaItem(){const e=K();this.localMeetup.agenda.length&&(e.startsAt=this.localMeetup.agenda[this.localMeetup.agenda.length-1].endsAt),this.localMeetup.agenda.push(e)},removeAgendaItem(e){this.localMeetup.agenda.splice(e,1)},handleSubmit(){this.$emit("submit",h(this.localMeetup))}}},Ae=e=>(H("data-v-f6e31de3"),e=e(),J(),e),we={class:"meetup-form__content"},Me={class:"meetup-form__section"},Ve=Ae(()=>r("h3",{class:"meetup-form__agenda-title"},"\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430",-1)),Se={class:"meetup-form__append"},ke={class:"meetup-form__aside"},Oe={class:"meetup-form__aside-stick"};function De(e,t,o,u,n,a){const d=g("UiInput"),p=g("UiFormGroup"),f=g("UiInputDate"),v=g("UiImageUploader"),l=g("MeetupAgendaItemForm"),b=g("UiButton");return m(),I("form",{class:"meetup-form",onSubmit:t[8]||(t[8]=z((...s)=>a.handleSubmit&&a.handleSubmit(...s),["prevent"]))},[r("div",we,[r("fieldset",Me,[i(p,{label:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},{default:_(()=>[i(d,{modelValue:n.localMeetup.title,"onUpdate:modelValue":t[0]||(t[0]=s=>n.localMeetup.title=s),name:"title"},null,8,["modelValue"])]),_:1}),i(p,{label:"\u0414\u0430\u0442\u0430"},{default:_(()=>[i(f,{modelValue:n.localMeetup.date,"onUpdate:modelValue":t[1]||(t[1]=s=>n.localMeetup.date=s),type:"date",name:"date"},null,8,["modelValue"])]),_:1}),i(p,{label:"\u041C\u0435\u0441\u0442\u043E"},{default:_(()=>[i(d,{modelValue:n.localMeetup.place,"onUpdate:modelValue":t[2]||(t[2]=s=>n.localMeetup.place=s),name:"place"},null,8,["modelValue"])]),_:1}),i(p,{label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435"},{default:_(()=>[i(d,{modelValue:n.localMeetup.description,"onUpdate:modelValue":t[3]||(t[3]=s=>n.localMeetup.description=s),multiline:"",rows:"3",name:"description"},null,8,["modelValue"])]),_:1}),i(p,{label:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435"},{default:_(()=>[i(v,{name:"image",uploader:a.postImage,preview:n.localMeetup.image,onSelect:t[4]||(t[4]=s=>n.localMeetup.imageToUpload=s),onRemove:t[5]||(t[5]=s=>n.localMeetup.imageId=n.localMeetup.imageToUpload=null)},null,8,["uploader","preview"])]),_:1})]),Ve,(m(!0),I(M,null,V(n.localMeetup.agenda,(s,A)=>(m(),U(l,{key:s.id,"agenda-item":n.localMeetup.agenda[A],"onUpdate:agendaItem":F=>n.localMeetup.agenda[A]=F,class:"meetup-form__agenda-item",onRemove:F=>a.removeAgendaItem(A)},null,8,["agenda-item","onUpdate:agendaItem","onRemove"]))),128)),r("div",Se,[r("button",{class:"meetup-form__append-button",type:"button","data-test":"addAgendaItem",onClick:t[6]||(t[6]=(...s)=>a.addAgendaItem&&a.addAgendaItem(...s))}," + \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u044D\u0442\u0430\u043F \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B ")])]),r("div",ke,[r("div",Oe,[i(b,{class:"meetup-form__aside-button",block:"","data-test":"cancel",variant:"secondary",onClick:t[7]||(t[7]=s=>e.$emit("cancel"))},{default:_(()=>[O(" \u041E\u0442\u043C\u0435\u043D\u0430 ")]),_:1}),i(b,{variant:"primary",block:"",class:"meetup-form__aside-button",type:"submit","data-test":"submit"},{default:_(()=>[O(w(o.submitText),1)]),_:1})])])],32)}const Ce=S(Ue,[["render",De],["__scopeId","data-v-f6e31de3"]]);export{Ce as M,x as U,ne as a,re as b};
